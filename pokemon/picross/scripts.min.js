function seedFromString(e){var t,o,a,s=0;if(0===e.length)return!1;for(t=0,a=e.length;a>t;t++)o=e.charCodeAt(t),s=(s<<5)-s+o,s|=0;return Math.abs(s)}function randomPixel(e){if(!$("html").hasClass("anim"))return"transparent";var t=0,o=.3,a=t+(9301*e+49297)%233280/233280*(o-t);return"rgba(255, 255, 255, "+a+")"}var defaultOptions={grid:{value:!0,htmlClass:!1},supp:{value:!0,htmlClass:!0},anim:{value:!0,htmlClass:!0},bgs:{value:!0,htmlClass:!0},names:{value:!0,htmlClass:!0}},options={data:$.extend(!0,{},defaultOptions),save:function(){try{localStorage.setItem("picrossSolutionsOptions",JSON.stringify(options.data))}catch(e){return!1}},load:function(){try{if(localStorage.getItem("picrossSolutionsOptions")){console.log(localStorage.getItem("picrossSolutionsOptions"));var e=JSON.parse(localStorage.getItem("picrossSolutionsOptions"));options.data=$.extend(!0,{},e);for(var t in e)options.data[t]=e[t]}else options.save()}catch(o){options.data=$.extend(!0,{},defaultOptions)}$.each(options.data,function(e,t){options.update(e)})},update:function(e){options.data[e].htmlClass===!0&&options.data[e].value===!0?$("html").addClass(e):$("html").removeClass(e),options.data[e].value===!0?$(".toggle[data-opt="+e+"]").addClass("active"):$(".toggle[data-opt="+e+"]").removeClass("active")},toggle:function(e){options.data[e].value?options.data[e].value=!options.data[e].value:options.data[e].value=!0,options.update(e),options.save()},reset:function(){options.data=$.extend(!0,{},defaultOptions),options.save(),options.load()}},properties={scale:20,canvasWidth:10,canvasHeight:10,area:!1,level:!1,grid:!0,levelLoaded:!1,levelEnergy:0},navigation="",quickSelect="";$.each(solutions,function(e,t){navigation+='<a class="area" href="#" data-area="'+e+'">Area '+(e+1)+"</a>",quickSelect+='<a class="area" href="#" data-area="'+e+'">'+(e+1)+"</a>",navigation+='<div id="stages-'+e+'" class="area-levels">',$.each(t,function(t,o){navigation+='<a href="#" class="level" data-area="'+e+'" data-level="'+t+'"><span class="level-number">'+(e+1)+"-"+(t+1)+'</span><span class="level-name"> - '+o.name+"</span></a>"}),navigation+="</div>"}),$(document).ready(function(e){function t(){var e=$("#controls-toggle");"Show options"==e.text()?e.text("Hide options"):e.text("Show options"),$("html").hasClass("anim")?$("#controls").slideToggle():$("#controls").toggle()}function o(){var e=document.location.hash.substr(1).split("/");e[0]&&e[1]?(properties.area=e[0]-1,properties.level=e[1]-1,a.canvas.initialize(),a.canvas.drawLevel(),a.document.info()):a.canvas.unload(),ga("send","event","picrossSolutions","levelLoaded",properties.area+1+"-"+(properties.level+1))}$("body").removeClass("js-off").addClass("js-on"),$(".js-only").show(),$(".no-js").hide(),options.load(),properties.grid=options.data.grid.value,$("#levels").html(navigation),$("#quick-select").html(quickSelect),FastClick.attach(document.body);var a={document:{info:function(e,t){$("#name").text(solutions[properties.area][properties.level].name),$("#type").text(solutions[properties.area][properties.level].type),$("#stage").text(properties.area+1+"-"+(properties.level+1)),$("#size").text(properties.canvasWidth+"x"+properties.canvasHeight),$("#energy").text(properties.levelEnergy),$("html").attr("data-style",solutions[properties.area][properties.level].type.toLowerCase());var o="";properties.levelLoaded===!0&&(o+="Level "+(properties.area+1)+"-"+(properties.level+1),o+=" "+solutions[properties.area][properties.level].name,o+=" | "),o+="Pokemon Picross Solutions",document.title=o}},canvas:{initialize:function(e){properties.levelLoaded===!1&&(a.canvas.size(),a.canvas.grid(),$("#description").hide(),options.data.anim.value===!0?($("#solution-wrapper").fadeIn(250),$("#controls-toggle").slideDown()):($("#solution-wrapper").show(),$("#controls-toggle").show()),properties.levelLoaded=!0)},unload:function(){$("#solution-wrapper").hide(),options.data.anim.value===!0?($("#controls").slideUp(),$("#controls-toggle").slideUp(),$("#description").fadeIn(250)):($("#controls").hide(),$("#controls-toggle").hide(),$("#description").show()),$("html").attr("data-style",""),properties.levelLoaded=!1},zoom:function(e){properties.scale=20*(e/20),properties.levelLoaded&&a.canvas.drawLevel()},size:function(){$("#solution").width(properties.canvasWidth*properties.scale),$("#solution").height(properties.canvasHeight*properties.scale),s.width=properties.canvasWidth*properties.scale,s.height=properties.canvasHeight*properties.scale},draw:function(e,t,o){o?i.fillStyle=o:i.fillStyle="#000",i.fillRect(e*properties.scale,t*properties.scale,properties.scale,properties.scale)},grid:function(){if(properties.grid===!0)for(var e=properties.canvasWidth,t=properties.canvasHeight,o=Math.max(t,e),a="horizontal",s=0,l=0,n=1,r=1,p=o-1;p>=1;p--)"horizontal"==a&&(n=o*properties.scale,r=.5,s=p*properties.scale,l=0),"vertical"==a&&(n=.5,r=o*properties.scale,s=0,l=p*properties.scale),p%5===0?(i.fillStyle="#FB9105","horizontal"==a&&(r=1.5),"vertical"==a&&(n=1.5)):i.fillStyle="#888",i.fillRect(s,l,r,n),1==p&&"horizontal"==a&&(a="vertical",p=o)},drawLevel:function(){if(properties.levelLoaded){properties.levelEnergy=0;var e=solutions[properties.area][properties.level];properties.canvasWidth=e.matrix[0].length,properties.canvasHeight=e.matrix.length;var t=seedFromString(e.name);a.canvas.size(),$.each(e.matrix,function(e,o){$.each(o,function(o,s){s?(properties.levelEnergy++,a.canvas.draw(o,e)):a.canvas.draw(o,e,randomPixel(o*e*t))})}),a.canvas.grid()}}}},s=document.getElementById("solution"),i=s.getContext("2d");$(document).on("click",".level",function(e){e.preventDefault(),properties.levelLoaded===!0&&a.canvas.initialize(),i.clearRect(0,0,s.width,s.height),properties.area=$(this).data("area"),properties.level=$(this).data("level"),document.location.hash=properties.area+1+"/"+(properties.level+1),a.canvas.drawLevel(),a.document.info(),"Select level"==$("#mobile-nav-toggle").text()?$("#mobile-nav-toggle").text("Close menu"):$("#mobile-nav-toggle").text("Select level"),setTimeout(function(){$("html").removeClass("nav-active")},50)}),$(document).on("click","#levels .area",function(e){e.preventDefault(),$("html").toggleClass("qs")}),$(document).on("click","#quick-select .area",function(e){e.preventDefault(),$("html").toggleClass("qs");var t=$(this).data("area");ga("send","event","picrossSolutions","areaClick",t);var o=$('#levels .area[data-area="'+t+'"]'),a=o.offset().top+$("#area-select").scrollTop()-$("#area-select").offset().top;$("html").hasClass("anim")?$("#area-select").animate({scrollTop:a},500):$("#area-select").scrollTop(a)}),$("#zoom").on("change",function(){a.canvas.zoom($(this).val())}).on("change mousemove touchmove",function(){$("#zoom-level").text("x"+(Math.round($(this).val()/2*100)/100).toFixed(2))}),$("#grid").click(function(){properties.grid=!properties.grid,a.canvas.drawLevel()}),$(".toggle").click(function(){var e=$(this).attr("data-opt");options.toggle(e),ga("send","event","picrossSolutions","options",e+" - "+options.data[e].value)}),$("#anim").click(function(){a.canvas.drawLevel()}),$("#reset-options").click(function(e){e.preventDefault(),options.reset(),properties.grid=options.data.grid.value,a.canvas.drawLevel()}),$("#controls-toggle").click(function(){t()}),$("#mobile-nav-toggle").click(function(e){"Select level"==$(this).text()?$(this).text("Close menu"):$(this).text("Select level"),e.preventDefault(),$("html").toggleClass("nav-active")}),$("body").click(function(e){0===$(e.target).closest("#controls-wrapper").length&&$("#controls").is(":visible")&&t(),0===$(e.target).closest("#area-select, #mobile-nav-toggle").length&&$("html").removeClass("nav-active")}),$("#zoom").val("20"),document.location.hash&&o(),"onhashchange"in window&&$(window).bind("hashchange",function(){o()}),$("#toggle-support").click(function(e){if(e.preventDefault(),!$("#support-options").is(":visible"))var t=!0;$("#support-options").stop().slideToggle(),t&&$("html, body").animate({scrollTop:$("#support-options").offset().top},500),ga("send","event","picrossSolutions","supportWrapperToggle",$("#support-options").is(":visible"))}),$(".paypal-button").click(function(e){ga("send","event","picrossSolutions","supportOptionClicked","paypalButton")}),$("#amazon-links .link").click(function(e){ga("send","event","picrossSolutions","supportOptionClicked",'amazon "'+$(".name",this).text()+'"')})});